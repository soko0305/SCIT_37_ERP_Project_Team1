<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project.erp.dao.SalesMapper">


<insert id="insertSales" parameterType="com.project.erp.vo.Sales">
Insert into Sales
values(
#{sales_ordernum},
#{buyerseq},
to_char(sysdate,'yyyy.mm.dd hh24:mi'),
'승인대기',
#{sales_totalprice},
#{sales_title},
#{buyer_corp}
)
</insert>

<insert id="insertSalesDetail" parameterType="com.project.erp.vo.SalesDetail">
insert into salesdetail
values(
salesdetailseq.nextval,
#{salesdetail_name},
#{salesdetail_amount},
#{salesdetail_price},
#{sales_ordernum},
#{pd_code}
)
</insert>



<select id="selectAllSales" resultType="com.project.erp.vo.Sales">
select *
from sales
</select> 

<select id="selectSalesDetail" parameterType="com.project.erp.vo.SalesDetail" resultType="com.project.erp.vo.SalesDetail">
select *
from salesdetail
where sales_ordernum=#{sales_ordernum}
</select>
</mapper>

<select id="selectOneBuyer" parameterType="com.project.erp.vo.Buyer" resultType="com.project.erp.vo.Buyer">
select buyerseq
from buyer
where buyer_corp = #{buyer_corp}
</select>



<update id="updateSalesStatus" parameterType="com.project.erp.vo.Sales">
update sales
set
<if test="status='승인대기'">
status='승인완료'
</if>
where
sales_ordernum=#{sales_ordernum}
</update>